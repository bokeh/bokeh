<div id="codepen-html">
<!--
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Complete Example</title>

{{css_block}}
{{script_block}}

<script>
//The order of CSS and JS imports above is important.
</script>
</head>

<body>
</body>
</html>
-->
</div>
<script>
    $(function() {
        var HTML = "";
        var htmlEl = document.getElementById("codepen-html");
        for(var i=0; i < htmlEl.childNodes.length; i++){
            //nodeType == 8 is the special number for comment nodes
            if(htmlEl.childNodes[i].nodeType == 8){  
                HTML = htmlEl.childNodes[i].textContent;
            }
        }
        console.log("HTML", HTML);
        $(".codepen-wrap ").each(function(iterEl) {
                var el = $(this),
                        type = "js",
                        codeInside = el.find('.codepen-content')[0].innerText,
                        isCodeInside = codeInside.length,
                        CSS = "",
                        JS = JS = codeInside;

                var data = {
                  title              : el.attr('data-codepen-title'),
                  description        : "",
                  html               : HTML,
                  html_pre_processor : "none",
                  css                : CSS,
                  css_pre_processor  : "none",
                  css_starter        : "neither",
                  css_prefix_free    : false,
                  js                 : JS,
                  js_pre_processor   : "none",
                  js_modernizr       : false,
                  js_library         : "",
                  html_classes       : "",
                  css_external       : "",
                  js_external        : "",
                  template           : true
                };
                var JSONstring =
                  JSON.stringify(data)
                  // Quotes will screw up the JSON
                  .replace(/"/g, "&quot;")
                  .replace(/'/g, "&apos;");
                var jsonInput ='<input type="hidden" name="data" value=\'' +
                          JSONstring + '\'>';
                el.find('form').append(jsonInput);
          });
        });

</script>
